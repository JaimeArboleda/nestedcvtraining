
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.0, mkdocs-material-8.5.6">
    
    
      
        <title>Report - Nested Cross Validation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.20d9efc8.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.cbb835fc.min.css">
        
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#nestedcvtraining.utils.reporting" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Nested Cross Validation" class="md-header__button md-logo" aria-label="Nested Cross Validation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Nested Cross Validation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Report
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Nested Cross Validation" class="md-nav__button md-logo" aria-label="Nested Cross Validation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Nested Cross Validation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../examples/" class="md-nav__link">
        Examples
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" checked>
      
      
      
      
        <label class="md-nav__link" for="__nav_3">
          Reference
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" aria-label="Reference" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Reference
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        Api
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Report
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Report
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting" class="md-nav__link">
    nestedcvtraining.utils.reporting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report" class="md-nav__link">
    Report
  </a>
  
    <nav class="md-nav" aria-label="Report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.get_best_params" class="md-nav__link">
    get_best_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.get_outer_metrics_report" class="md-nav__link">
    get_outer_metrics_report()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.iter_models_test_idxs" class="md-nav__link">
    iter_models_test_idxs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.to_dataframe" class="md-nav__link">
    to_dataframe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../SwitchCase/" class="md-nav__link">
        SwitchCase
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../UnderSamplingClassifier/" class="md-nav__link">
        UnderSamplingClassifier
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting" class="md-nav__link">
    nestedcvtraining.utils.reporting
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report" class="md-nav__link">
    Report
  </a>
  
    <nav class="md-nav" aria-label="Report">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.get_best_params" class="md-nav__link">
    get_best_params()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.get_outer_metrics_report" class="md-nav__link">
    get_outer_metrics_report()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.iter_models_test_idxs" class="md-nav__link">
    iter_models_test_idxs()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nestedcvtraining.utils.reporting.Report.to_dataframe" class="md-nav__link">
    to_dataframe()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Report</h1>

<div class="doc doc-object doc-module">


<a id="nestedcvtraining.utils.reporting"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h2 id="nestedcvtraining.utils.reporting.Report" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">Report</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h2>


  <div class="doc doc-contents ">

  
      <p>Nested Cross Validation Report</p>
<p>It contains in a single dataclass all relevant information concerning the training loop.</p>
<p>In addition, it has several handy methods for comparing the performance on all folds,
comparing the best params found on all folds, and iterating over all models (with their corresponding
outer fold) for further custom checks.</p>
<p>It contains one element (row when converted to a dataframe) for each trained model during the inner loop
including the refitted model over the whole inner dataset. That is, if the number of outer folds is k_o and the
number of inner folds is k_i, and s_o and s_i folds are skipped respectively, then the number of rows will be:
(k_o - s_o) * (k_i - s_i + 1), where the + 1 is added for the refitting of the best model on the whole
(X_outer_train, y_outer_train).</p>
<p>The attributes section contains all available information for each model (row).</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>best</code></td>
          <td>
                <code>list(bool)</code>
          </td>
          <td><p>list of boolean values where True corresponds to the models that
have been refitted and trained over the whole (X_outer_train, y_outer_train).</p></td>
        </tr>
        <tr>
          <td><code>outer_kfold</code></td>
          <td>
                <code>list(int)</code>
          </td>
          <td><p>list of integers that hold the correspondence between each
model and the corresponding outer fold.</p></td>
        </tr>
        <tr>
          <td><code>params</code></td>
          <td>
                <code>list(dict)</code>
          </td>
          <td><p>list of dictionaries holding the parameters of each model</p></td>
        </tr>
        <tr>
          <td><code>inner_validation_metrics</code></td>
          <td>
                <code>dict(list)</code>
          </td>
          <td><p>dictionary containing a list for each metric
as averaged over all inner validation folds.</p></td>
        </tr>
        <tr>
          <td><code>outer_test_metrics</code></td>
          <td>
                <code>dict(list)</code>
          </td>
          <td><p>dictionary containing a list for each metric
as computed over the outer folds (only available for the best model of each outer
fold). This is the most important piece for checking performance evaluation.</p></td>
        </tr>
        <tr>
          <td><code>model</code></td>
          <td>
                <code>list(estimator)</code>
          </td>
          <td><p>list of models (only available for the best model of each outer
fold).</p></td>
        </tr>
        <tr>
          <td><code>outer_test_indexes</code></td>
          <td>
                <code>list(ndarray)</code>
          </td>
          <td><p>list of indexes for corresponding outer fold for each
model. This attribute, with the previous one, are output to make it easier to perform
further checks.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>nestedcvtraining/utils/reporting.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span> <span class="nc">Report</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot; Nested Cross Validation Report</span>

<span class="sd">    It contains in a single dataclass all relevant information concerning the training loop.</span>

<span class="sd">    In addition, it has several handy methods for comparing the performance on all folds,</span>
<span class="sd">    comparing the best params found on all folds, and iterating over all models (with their corresponding</span>
<span class="sd">    outer fold) for further custom checks.</span>

<span class="sd">    It contains one element (row when converted to a dataframe) for each trained model during the inner loop</span>
<span class="sd">    including the refitted model over the whole inner dataset. That is, if the number of outer folds is k_o and the</span>
<span class="sd">    number of inner folds is k_i, and s_o and s_i folds are skipped respectively, then the number of rows will be:</span>
<span class="sd">    (k_o - s_o) * (k_i - s_i + 1), where the + 1 is added for the refitting of the best model on the whole</span>
<span class="sd">    (X_outer_train, y_outer_train).</span>

<span class="sd">    The attributes section contains all available information for each model (row).</span>

<span class="sd">    Attributes:</span>
<span class="sd">        best (list(bool) ): list of boolean values where True corresponds to the models that</span>
<span class="sd">            have been refitted and trained over the whole (X_outer_train, y_outer_train).</span>
<span class="sd">        outer_kfold (list(int) ): list of integers that hold the correspondence between each</span>
<span class="sd">            model and the corresponding outer fold.</span>
<span class="sd">        params (list(dict) ): list of dictionaries holding the parameters of each model</span>
<span class="sd">        inner_validation_metrics (dict(list) ): dictionary containing a list for each metric</span>
<span class="sd">            as averaged over all inner validation folds.</span>
<span class="sd">        outer_test_metrics (dict(list) ): dictionary containing a list for each metric</span>
<span class="sd">            as computed over the outer folds (only available for the best model of each outer</span>
<span class="sd">            fold). This is the most important piece for checking performance evaluation.</span>
<span class="sd">        model (list(estimator) ): list of models (only available for the best model of each outer</span>
<span class="sd">            fold).</span>
<span class="sd">        outer_test_indexes (list(ndarray) ): list of indexes for corresponding outer fold for each</span>
<span class="sd">            model. This attribute, with the previous one, are output to make it easier to perform</span>
<span class="sd">            further checks.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">best</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">outer_kfold</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">params</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">inner_validation_metrics</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
    <span class="n">outer_test_metrics</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="k">lambda</span><span class="p">:</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">))</span>
    <span class="n">model</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>
    <span class="n">outer_test_indexes</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">list</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; It converts the information to a dataframe.</span>
<span class="sd">        Returns:</span>
<span class="sd">            df (dataframe): A dataframe with one row per trained model, with all attached information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">self_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
        <span class="n">inner_validation_metrics</span> <span class="o">=</span> <span class="n">self_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;inner_validation_metrics&quot;</span><span class="p">)</span>
        <span class="n">outer_test_metrics</span> <span class="o">=</span> <span class="n">self_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;outer_test_metrics&quot;</span><span class="p">)</span>
        <span class="n">all_params</span> <span class="o">=</span> <span class="n">self_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;params&quot;</span><span class="p">)</span>
        <span class="n">all_params_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([[</span><span class="n">ik</span> <span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">]</span> <span class="k">for</span> <span class="n">ks</span> <span class="ow">in</span> <span class="n">all_params</span><span class="p">])))</span>
        <span class="k">for</span> <span class="n">param_key</span> <span class="ow">in</span> <span class="n">all_params_keys</span><span class="p">:</span>
            <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;param__&quot;</span> <span class="o">+</span> <span class="n">param_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">all_params</span><span class="p">:</span>
                <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;param__&quot;</span> <span class="o">+</span> <span class="n">param_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">inner_validation_metrics</span><span class="p">:</span>
            <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;inner_validation_metrics__&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inner_validation_metrics</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">outer_test_metrics</span><span class="p">:</span>
            <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;outer_test_metrics__&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">self_dict</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_append</span><span class="p">(</span>
            <span class="bp">self</span><span class="p">,</span> <span class="n">best</span><span class="p">,</span> <span class="n">outer_kfold</span><span class="p">,</span> <span class="n">params</span><span class="p">,</span> <span class="n">inner_validation_metrics</span><span class="p">,</span> <span class="n">outer_test_metrics</span><span class="p">,</span> <span class="n">model</span><span class="p">,</span> <span class="n">outer_test_indexes</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">best</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_kfold</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outer_kfold</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_test_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">outer_test_indexes</span><span class="p">)</span>
        <span class="n">_extend_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_validation_metrics</span><span class="p">,</span> <span class="n">inner_validation_metrics</span><span class="p">)</span>
        <span class="n">_extend_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">,</span> <span class="n">outer_test_metrics</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_extend</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">best</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">best</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_kfold</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">outer_kfold</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">params</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">model</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outer_test_indexes</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">other</span><span class="o">.</span><span class="n">outer_test_indexes</span><span class="p">)</span>
        <span class="n">_extend_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">inner_validation_metrics</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">inner_validation_metrics</span><span class="p">)</span>
        <span class="n">_extend_nested_dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">,</span> <span class="n">other</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_best_idx</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">best</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">best</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">best</span><span class="p">:</span>
                <span class="k">yield</span> <span class="n">idx</span>

    <span class="k">def</span> <span class="nf">get_best_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_diff</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; It outputs the parameters of all best models, to check to what extent they differ.</span>
<span class="sd">        Args:</span>
<span class="sd">            only_diff (bool): If True, only the parameters where thhere is a difference among all models</span>
<span class="sd">                are output. Otherwise, all params are output.</span>
<span class="sd">        Returns:</span>
<span class="sd">            params (dict): A dictionary where the keys are the param names and the values are</span>
<span class="sd">                lists of corresponding values (one per best model).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">best_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_idx</span><span class="p">()]</span>
        <span class="n">params</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">best_idxs</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
                <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">only_diff</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span>
                <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">alist</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span>
            <span class="n">alist</span><span class="p">[</span><span class="n">idx</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_idx</span><span class="p">()</span>
        <span class="p">]</span>

    <span class="k">def</span> <span class="nf">get_outer_metrics_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; It outputs a basic report of outer metrics. For each outer metric, it outputs</span>
<span class="sd">        the mean, sd and range.</span>

<span class="sd">        Returns:</span>
<span class="sd">            metrics_report (dict): A nested dictionary where outer keys are metric names and</span>
<span class="sd">                inner keys are `mean`, `sd`, `min`, `max`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">metric_report</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">:</span>
            <span class="n">metric_report</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
                <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
                <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
                <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
            <span class="p">}</span>
        <span class="k">return</span> <span class="n">metric_report</span>

    <span class="k">def</span> <span class="nf">iter_models_test_idxs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Iterator that yields all refitted models with their corresponding</span>
<span class="sd">        outer test indexes, so that it&#39;s easy to compute other metrics or make</span>
<span class="sd">        some custom plots to check the performance.</span>

<span class="sd">        Yields:</span>
<span class="sd">            t (tuple): a tuple containing model and test_idxs</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_indexes</span><span class="p">)):</span>
            <span class="k">yield</span> <span class="n">t</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">









<div class="doc doc-object doc-function">



<h3 id="nestedcvtraining.utils.reporting.Report.get_best_params" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_best_params</span>


</h3>
<div class="highlight"><pre><span></span><code><span class="n">get_best_params</span><span class="p">(</span><span class="n">only_diff</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>It outputs the parameters of all best models, to check to what extent they differ.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>only_diff</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>If True, only the parameters where thhere is a difference among all models
are output. Otherwise, all params are output.</p></td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>params</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>A dictionary where the keys are the param names and the values are
lists of corresponding values (one per best model).</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>nestedcvtraining/utils/reporting.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_best_params</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">only_diff</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; It outputs the parameters of all best models, to check to what extent they differ.</span>
<span class="sd">    Args:</span>
<span class="sd">        only_diff (bool): If True, only the parameters where thhere is a difference among all models</span>
<span class="sd">            are output. Otherwise, all params are output.</span>
<span class="sd">    Returns:</span>
<span class="sd">        params (dict): A dictionary where the keys are the param names and the values are</span>
<span class="sd">            lists of corresponding values (one per best model).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">best_idxs</span> <span class="o">=</span> <span class="p">[</span><span class="n">idx</span> <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_best_idx</span><span class="p">()]</span>
    <span class="n">params</span> <span class="o">=</span> <span class="n">defaultdict</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">idx</span> <span class="ow">in</span> <span class="n">best_idxs</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">]:</span>
            <span class="n">params</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">params</span><span class="p">[</span><span class="n">idx</span><span class="p">][</span><span class="n">k</span><span class="p">])</span>
    <span class="k">if</span> <span class="n">only_diff</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="n">k</span><span class="p">:</span> <span class="n">v</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">v</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">1</span>
        <span class="p">}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">dict</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="nestedcvtraining.utils.reporting.Report.get_outer_metrics_report" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_outer_metrics_report</span>


</h3>
<div class="highlight"><pre><span></span><code><span class="n">get_outer_metrics_report</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>It outputs a basic report of outer metrics. For each outer metric, it outputs
the mean, sd and range.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>metrics_report</code></td>          <td>
                <code>dict</code>
          </td>
          <td><p>A nested dictionary where outer keys are metric names and
inner keys are <code>mean</code>, <code>sd</code>, <code>min</code>, <code>max</code>.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>nestedcvtraining/utils/reporting.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_outer_metrics_report</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; It outputs a basic report of outer metrics. For each outer metric, it outputs</span>
<span class="sd">    the mean, sd and range.</span>

<span class="sd">    Returns:</span>
<span class="sd">        metrics_report (dict): A nested dictionary where outer keys are metric names and</span>
<span class="sd">            inner keys are `mean`, `sd`, `min`, `max`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">metric_report</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">metric</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">:</span>
        <span class="n">metric_report</span><span class="p">[</span><span class="n">metric</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;mean&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
            <span class="s2">&quot;sd&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
            <span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="nb">min</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
            <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="nb">max</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">metric</span><span class="p">])),</span>
        <span class="p">}</span>
    <span class="k">return</span> <span class="n">metric_report</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="nestedcvtraining.utils.reporting.Report.iter_models_test_idxs" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">iter_models_test_idxs</span>


</h3>
<div class="highlight"><pre><span></span><code><span class="n">iter_models_test_idxs</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Iterator that yields all refitted models with their corresponding
outer test indexes, so that it's easy to compute other metrics or make
some custom plots to check the performance.</p>

  <p><strong>Yields:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>t</code></td>          <td>
                <code>tuple</code>
          </td>
          <td><p>a tuple containing model and test_idxs</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>nestedcvtraining/utils/reporting.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">iter_models_test_idxs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Iterator that yields all refitted models with their corresponding</span>
<span class="sd">    outer test indexes, so that it&#39;s easy to compute other metrics or make</span>
<span class="sd">    some custom plots to check the performance.</span>

<span class="sd">    Yields:</span>
<span class="sd">        t (tuple): a tuple containing model and test_idxs</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">model</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">_filter_only_best</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outer_test_indexes</span><span class="p">)):</span>
        <span class="k">yield</span> <span class="n">t</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="nestedcvtraining.utils.reporting.Report.to_dataframe" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">to_dataframe</span>


</h3>
<div class="highlight"><pre><span></span><code><span class="n">to_dataframe</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>It converts the information to a dataframe.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>df</code></td>          <td>
                <code>dataframe</code>
          </td>
          <td><p>A dataframe with one row per trained model, with all attached information.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>nestedcvtraining/utils/reporting.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">to_dataframe</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; It converts the information to a dataframe.</span>
<span class="sd">    Returns:</span>
<span class="sd">        df (dataframe): A dataframe with one row per trained model, with all attached information.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">self_dict</span> <span class="o">=</span> <span class="n">copy</span><span class="o">.</span><span class="n">deepcopy</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
    <span class="n">inner_validation_metrics</span> <span class="o">=</span> <span class="n">self_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;inner_validation_metrics&quot;</span><span class="p">)</span>
    <span class="n">outer_test_metrics</span> <span class="o">=</span> <span class="n">self_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;outer_test_metrics&quot;</span><span class="p">)</span>
    <span class="n">all_params</span> <span class="o">=</span> <span class="n">self_dict</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s2">&quot;params&quot;</span><span class="p">)</span>
    <span class="n">all_params_keys</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">(</span><span class="nb">set</span><span class="p">(</span><span class="n">chain</span><span class="o">.</span><span class="n">from_iterable</span><span class="p">([[</span><span class="n">ik</span> <span class="k">for</span> <span class="n">ik</span> <span class="ow">in</span> <span class="n">ks</span><span class="p">]</span> <span class="k">for</span> <span class="n">ks</span> <span class="ow">in</span> <span class="n">all_params</span><span class="p">])))</span>
    <span class="k">for</span> <span class="n">param_key</span> <span class="ow">in</span> <span class="n">all_params_keys</span><span class="p">:</span>
        <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;param__&quot;</span> <span class="o">+</span> <span class="n">param_key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">param</span> <span class="ow">in</span> <span class="n">all_params</span><span class="p">:</span>
            <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;param__&quot;</span> <span class="o">+</span> <span class="n">param_key</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">param</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">param_key</span><span class="p">,</span> <span class="kc">None</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">inner_validation_metrics</span><span class="p">:</span>
        <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;inner_validation_metrics__&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">inner_validation_metrics</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">outer_test_metrics</span><span class="p">:</span>
        <span class="n">self_dict</span><span class="p">[</span><span class="s2">&quot;outer_test_metrics__&quot;</span> <span class="o">+</span> <span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">outer_test_metrics</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">self_dict</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>




  </div>

  </div>

</div>





                
              </article>
            </div>
          
          
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
    <nav class="md-footer__inner md-grid" aria-label="Footer" >
      
        
        <a href="../api/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Api" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Api
            </div>
          </div>
        </a>
      
      
        
        <a href="../SwitchCase/" class="md-footer__link md-footer__link--next" aria-label="Next: SwitchCase" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              SwitchCase
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "..", "features": [], "search": "../assets/javascripts/workers/search.5bf1dace.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version.title": "Select version"}}</script>
    
    
      <script src="../assets/javascripts/bundle.078830c0.min.js"></script>
      
    
  </body>
</html>